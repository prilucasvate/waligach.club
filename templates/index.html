<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@700&family=Zen+Maru+Gothic:wght@700&display=swap" rel="stylesheet">

  <meta charset="UTF-8">
  <title>抽!!!</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
</head>
<!-- made by waligach in 2025 -->
<body>
  <div id="nameModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
    backgrounloadingTextd: rgba(0,0,0,0.5); justify-content: center; align-items: center; z-index: 999;">
    <div style="background: rgba(255, 255, 255, 0.855); padding: 24px 32px; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.2); text-align: center;">
      <h1 style="margin-bottom: 12px;"> 嗨！你是誰？</h1>
      <input id="nameInput" type="text" placeholder="你叫啥來著" style="padding: 12px; font-size: 18px; width: 100%; border-radius: 8px; border: 1px solid #ccc;">
      <button onclick="saveUserName()" style="margin-top: 16px; padding: 10px 16px; font-size: 20px; border: none;font-family: 'Zen Maru Gothic', 'Noto Sans TC', sans-serif; border-radius: 8px; background: #ff85b2; color: white; cursor: pointer;">
        忍不住要進去了 ><
      </button>
      <div class="note">※ 亂填讓我認錯人的 我一定有辦法找到你 🫠</div>
    </div>
  </div>
  
  <div class="container">
    <div class="title-row">
      <h1>欸要吃什麼？</h1>
      <!-- <button id="travelBtn"
              class="fancy-button travel-btn"
              onclick="location.href='/travel'">
              <img src="{{ url_for('static', filename='korea.png') }}" alt="korea" style="width: 25px; height: auto;">
      </button> -->
    </div>
    <!-- <h1>欸要吃什麼？</h1>
    <button class="fancy-button draw-control-button"
        style="background: linear-gradient(to right,#82d1f9,#7ceeda);"
        onclick="location.href='/travel'">
        旅遊時間表
    </button> -->
     <!--  看哪裡能用 -->
    <!-- ----------------------for repo start------------------------------------- -->
    <!-- 1. 浮動按鈕：保持不動 -->
    <button id="repository-btn" class="fab" aria-label="倉庫">📦 </button>

    <!-- 2. 抽屜容器 -->
    <div id="repository-drawer" class="drawer hidden">
      <div class="drawer-header">
        <h3>📦 我的倉庫 <span id="folder-count"></span></h3>
        <button id="drawer-close" class="icon-btn">--</button>
      </div>

      <!-- 捲動內容 -->
      <div id="repository-body"></div>

      <!--新增資料夾 -->
      <div class="drawer-footer">
        <input id="new-folder-name" placeholder="新增資料夾名稱">
        <button id="add-folder">＋ 新增資料夾</button>
      </div>
    </div>

    <!-- 3. 遮罩（點擊可關閉） -->
    <div id="drawer-backdrop" class="backdrop hidden"></div>

    <!-- -------------------repo end---------------------------------------------- -->
    <img src="{{ url_for('static', filename='random.png') }}" alt="random">
    <br>
    <div>
      <input id="newOption" type="text" placeholder="加個選項">
      <button class="fancy-button" onclick="addOption()">加進選項吧 ~</button>
      <button class="fancy-button" onclick="confirmReset()" >全部重設 !</button>
    </div>

    <h2 class="gradient-title" >目前選項：</h2>
    <ul id="optionList"></ul>
    <div class="draw-controls" style="display: flex; justify-content: space-between; align-items: center; gap: 12px; margin: 16px 0;">
      <button id="quickDrawBtn" onclick="quickDraw()" class="fancy-button draw-control-button" style=" background: linear-gradient(to right, #e5c062eb, #efbe42dd); ">快速抽</button>
      <button id="mainButton" class="fancy-button" onclick="draw()">幫我選吧 !!</button>
      <button onclick="toggleLock()" id="lockBtn" class="fancy-button draw-control-button" style=" background: linear-gradient(to right, #a4a1e4f1, #9690e7ee); ">鎖定</button>
    </div>
    
    <h2 id="result" >我來幫你選 ! </h2>
    <p id="drawTime" style="color: gray; font-size: 16px;"></p>
    <div id="history-area" style="margin-top: 20px;">
      <h2 class="gradient-title">抽選紀錄 ( 近五筆 ):</h2>
      <ul id="history-list" style="padding-left: 0;"></ul>
    </div>
    <div class="user-info-area">
      <button  id="resetUserBtn" class="switch-user-button" onclick="resetUser()">更換使用者</button>
      <span id="currentUserDisplay" class="current-user-text"></span>
    </div>
    
    <div id="online-area" style="margin-top:24px;">
      <div style="display: flex; justify-content: space-between; align-items: center; border-bottom: 3px solid #dd9de1; padding-bottom: 4px; margin-bottom: 12px;">
        <!-- 取消底線自己畫 -->
        <h2 class="gradient-title" style="margin: 0;border-bottom: none;">現在在線 ( <span id="online-count">0</span> )</h2> 
        <button onclick="addOnlineUsersToOptions()" 
                class="fancy-button"
                style="font-size: 16px; padding: 6px 16px; width: auto; max-width: 160px; white-space: nowrap; background: linear-gradient(to right, #d355e9dd, #6fb0eddf); ">
          👥 加進選項
        </button>
      </div>

      <ul id="online-list" style="padding-left:0;"></ul>
    </div>
    <h4 style="color:rgba(176, 175, 175, 0.889);font-family: 'Zen Maru Gothic', 'Noto Sans TC', sans-serif; text-align: center;"> ★ made by waligach in 2025 (with py, corn) </h4>
    
     <!-- 轉盤 Overlay -->
    <div id="wheel-overlay" class="wheel-overlay hidden">
      <div class="wheel-container">
        <div class="wheel-pointer"></div>
        <canvas id="wheel-canvas" width="540" height="540"></canvas>
        <button id="wheel-close" class="wheel-close" onclick="if (!wheelSpinning) closeWheel()">✕</button>
      </div>
    </div>
    <script src="https://cdn.socket.io/3.1.3/socket.io.min.js"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
  </div>
  <!-- <h2> made by waligach in 2025 </h2> -->
</body>
</html>
